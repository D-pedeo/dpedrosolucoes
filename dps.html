<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D.Pedro Soluções - Sistema Integrado</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Variáveis CSS atualizadas */
        :root {
            --primary-color: #4361ee;
            --secondary-color: #3f37c9;
            --success-color: #4cc9f0;
            --warning-color: #ffc107;
            --info-color: #17a2b8;
            --danger-color: #dc3545;
            --light-color: #f8f9fa;
            --dark-color: #212529;
            --bg-color: #f5f7fb;
            --card-color: #ffffff;
            --text-color: #333333;
            --border-color: #e0e0e0;
            --sidebar-width: 280px;
            --sidebar-collapsed-width: 70px;
            --header-height: 80px;
        }

        [data-theme="dark"] {
            --bg-color: #121212;
            --card-color: #1e1e1e;
            --text-color: #e0e0e0;
            --border-color: #333333;
            --light-color: #2a2a2a;
            --dark-color: #f8f9fa;
        }

        * {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        /* Header Styles */
        .kanawa-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            height: var(--header-height);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo img {
            width: 40px;
            height: 40px;
            border-radius: 8px;
        }

        .logo span {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            font-size: 1.5rem;
        }

        .top-icons {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .menu-item {
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            transition: background-color 0.3s;
        }

        .menu-item:hover {
            background-color: rgba(255,255,255,0.1);
        }

        /* Main Container */
        .main-container {
            display: flex;
            min-height: calc(100vh - var(--header-height));
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--card-color);
            padding: 1.5rem;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            overflow-y: auto;
            position: sticky;
            top: var(--header-height);
            height: calc(100vh - var(--header-height));
            transition: width 0.3s ease;
        }

        .sidebar.collapsed {
            width: var(--sidebar-collapsed-width);
        }

        .sidebar.collapsed .sidebar-text {
            display: none;
        }

        .sidebar .menu-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            color: var(--text-color);
            text-decoration: none;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            transition: all 0.3s;
            border-left: 3px solid transparent;
        }

        .sidebar .menu-item:hover {
            background-color: var(--light-color);
            color: var(--primary-color);
        }

        .sidebar .menu-item.active {
            background-color: var(--primary-color);
            color: white;
            border-left: 3px solid white;
        }

        /* Content Area */
        .content {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            background-color: var(--bg-color);
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .page-title {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            color: var(--dark-color);
        }

        /* Buttons */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: white;
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
        }

        .btn-warning {
            background-color: var(--warning-color);
            color: white;
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
        }

        /* Cards */
        .card {
            background: var(--card-color);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin-bottom: 1.5rem;
            border: 1px solid var(--border-color);
        }

        .card h2 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--dark-color);
        }

        /* Dashboard Widgets */
        .dashboard-widget {
            background: var(--card-color);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            text-align: center;
            flex: 1;
            min-width: 200px;
            border: 1px solid var(--border-color);
        }

        .widget-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            color: white;
            font-size: 1.5rem;
        }

        .widget-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: var(--dark-color);
        }

        .widget-title {
            color: #666;
            margin-bottom: 0.5rem;
        }

        /* Filter Section */
        .filter-section {
            background: var(--card-color);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin-bottom: 1.5rem;
            border: 1px solid var(--border-color);
        }

        .filter-section h3 {
            margin-bottom: 1rem;
            color: var(--dark-color);
        }

        .filter-row {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }

        .filter-group {
            flex: 1;
            min-width: 200px;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark-color);
        }

        .form-control {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
            background-color: var(--card-color);
            color: var(--text-color);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
        }

        /* Data Table */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--card-color);
            border-radius: 8px;
            overflow: hidden;
        }

        .data-table th,
        .data-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .data-table th {
            background-color: var(--light-color);
            font-weight: 600;
            color: var(--dark-color);
        }

        .data-table tr:hover {
            background-color: var(--light-color);
        }

        /* Chart Container */
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }

        /* Notification Badge */
        .notification-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: var(--danger-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Dropdowns */
        .dropdown-menu {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--card-color);
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            padding: 1rem;
            min-width: 300px;
            z-index: 1000;
            margin-top: 0.5rem;
            border: 1px solid var(--border-color);
        }

        .user-dropdown {
            min-width: 200px;
        }

        /* AI Assistant Button */
        .ai-assistant {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            transition: all 0.3s;
            z-index: 1000;
        }

        .ai-assistant:hover {
            transform: scale(1.1);
        }

        .ai-assistant-pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Dark Mode Toggle */
        .dark-mode-toggle {
            position: fixed;
            bottom: 2rem;
            left: 2rem;
            width: 50px;
            height: 50px;
            background: var(--dark-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            transition: all 0.3s;
            z-index: 1000;
        }

        /* Notification Toast */
        .notification-toast {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: var(--card-color);
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            padding: 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            min-width: 300px;
            transform: translateX(400px);
            transition: transform 0.3s ease-in-out;
            z-index: 1050;
            border: 1px solid var(--border-color);
        }

        .notification-toast.show {
            transform: translateX(0);
        }

        .notification-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        .notification-close {
            background: none;
            border: none;
            color: #999;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s;
        }

        .notification-close:hover {
            background: var(--light-color);
            color: #666;
        }

        /* Progress Bar */
        .progress {
            height: 8px;
            background-color: var(--light-color);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--success-color);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        /* Status Badges */
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .status-active {
            background-color: rgba(40, 167, 69, 0.2);
            color: #28a745;
        }

        .status-inactive {
            background-color: rgba(220, 53, 69, 0.2);
            color: #dc3545;
        }

        .status-pending {
            background-color: rgba(255, 193, 7, 0.2);
            color: #ffc107;
        }

        /* AI Chat Messages */
        .chat-messages {
            height: 400px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            background: var(--light-color);
        }

        .chat-message {
            margin-bottom: 15px;
            padding: 10px 15px;
            border-radius: 15px;
            max-width: 80%;
        }

        .user-message {
            background-color: var(--primary-color);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }

        .ai-message {
            background-color: var(--border-color);
            color: var(--text-color);
            border-bottom-left-radius: 5px;
        }

        .system-message {
            background-color: var(--light-color);
            color: var(--text-color);
        }

        /* API Status Indicators */
        .api-status {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .api-status.connected {
            background: var(--success-color);
            color: white;
        }

        .api-status.disconnected {
            background: var(--danger-color);
            color: white;
        }

        .api-status.connecting {
            background: var(--warning-color);
            color: white;
        }

        /* Loading Spinner */
        .spinner {
            border: 2px solid #f3f3f3;
            border-top: 2px solid var(--primary-color);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                order: 2;
                height: auto;
                position: relative;
                top: 0;
            }

            .sidebar.collapsed {
                width: 100%;
            }
            
            .content {
                order: 1;
                margin-left: 0 !important;
                width: 100%;
                padding: 1rem;
            }
            
            .kanawa-header {
                padding: 1rem;
                flex-direction: column;
                gap: 1rem;
                height: auto;
            }
            
            .top-icons {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .filter-row {
                flex-direction: column;
            }
            
            .filter-group {
                min-width: 100%;
            }
            
            .dashboard-widget {
                min-width: 100%;
            }
            
            .ai-assistant, .dark-mode-toggle {
                bottom: 1rem;
            }
            
            .ai-assistant {
                right: 1rem;
            }
            
            .dark-mode-toggle {
                left: 1rem;
            }
        }

        /* Sidebar Toggle Button */
        .sidebar-toggle {
            display: none;
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 1100;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        @media (max-width: 768px) {
            .sidebar-toggle {
                display: flex;
            }
            
            .sidebar {
                position: fixed;
                top: 0;
                left: -100%;
                z-index: 1000;
                height: 100vh;
                transition: left 0.3s ease;
            }
            
            .sidebar.show {
                left: 0;
            }
            
            .content {
                margin-left: 0 !important;
            }
        }

        /* Module Cards */
        .module-card {
            background: var(--card-color);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin-bottom: 1.5rem;
            border: 1px solid var(--border-color);
            transition: all 0.3s;
            cursor: pointer;
        }

        .module-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }

        .module-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
            color: white;
            font-size: 1.5rem;
        }

        .module-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--dark-color);
        }

        .module-description {
            color: #666;
            font-size: 0.9rem;
        }

        /* Connection Status */
        .connection-status {
            position: fixed;
            bottom: 6rem;
            left: 2rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .connection-status.connected {
            background-color: var(--success-color);
            color: white;
        }

        .connection-status.disconnected {
            background-color: var(--danger-color);
            color: white;
        }

        .connection-status.connecting {
            background-color: var(--warning-color);
            color: white;
        }

        /* User Profile Section */
        .user-profile-card {
            background: var(--card-color);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin-bottom: 1.5rem;
            border: 1px solid var(--border-color);
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary-color);
        }

        .profile-info h3 {
            margin: 0 0 0.5rem 0;
            color: var(--dark-color);
        }

        .profile-info p {
            margin: 0;
            color: #666;
        }

        .profile-stats {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .stat-item {
            text-align: center;
            flex: 1;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .stat-label {
            font-size: 0.9rem;
            color: #666;
        }
    </style>
</head>
<body>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6ZK2KZGMHG"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-6ZK2KZGMHG');
    </script>

    <!-- Sidebar Toggle Button (Mobile) -->
    <button class="sidebar-toggle" id="sidebarToggle">
        <i class="fas fa-bars"></i>
    </button>

    <header class="kanawa-header">
        <div class="logo">
            <a href='DPS.html'><img src='https://i.postimg.cc/fks90nbK/DPS-ICO.jpg' alt='DPS-ICO'/></a>
            <span>D.Pedro Soluções</span>
        </div>
        <div class="top-icons">
            <a href="cursos.html" class="menu-item"><i class="fas fa-graduation-cap"></i> <span>Cursos</span></a>
            <a href="servicos.html" class="menu-item"><i class="fas fa-briefcase"></i> <span>Serviços</span></a>
            <a href="loja-virtual.html" class="menu-item"><i class="fas fa-store"></i> <span>Lojas</span></a>
            <a href="download.html" class="menu-item"><i class="fas fa-download"></i> <span>Aplicativos</span></a>
            <a href="Rodango.html" class="menu-item"><i class="fas fa-comments"></i> <span>Rodango - Rede Social Multimídia</span></a>
            
            <div style="position:relative;">
                <a href="notificacoes.html" id="notificationsBtn" style="color:white;position:relative;">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge" id="notificationCount">0</span>
                </a>
                <div class="dropdown-menu" id="notificationsDropdown">
                    <h5 style="margin-bottom:1rem;">Notificações</h5>
                    <div id="notificationList">
                        <div class="text-center py-3">
                            <div class="spinner"></div>
                            <p class="mt-2">Carregando notificações...</p>
                        </div>
                    </div>
                    <a href="notificacoes.html" style="display:block;text-align:center;margin-top:1rem;color:var(--secondary-color);">Ver todas</a>
                </div>
            </div>
            
            <div style="position:relative;">
                <a href="profile.html" id="userMenuBtn" style="color:white;display:flex;align-items:center;">
                    <img id="userAvatar" src="https://i.postimg.cc/7YQvLZxX/user-avatar.jpg" alt="User" style="width:32px;height:32px;border-radius:50%;margin-right:8px;">
                    <span id="userName">Carregando...</span>
                </a>
                <div class="dropdown-menu user-dropdown" id="userMenuDropdown">
                    <a href="profile.html" class="menu-item" style="padding:0.5rem 0;display:block;color:var(--text-color);"><i class="fas fa-user"></i> Perfil</a>
                    <a href="configuracoes.html" class="menu-item" style="padding:0.5rem 0;display:block;color:var(--text-color);"><i class="fas fa-cog"></i> Configurações</a>
                    <a href="logout.html" class="menu-item" style="padding:0.5rem 0;display:block;color:var(--text-color);"><i class="fas fa-sign-out-alt"></i> Sair</a>
                </div>
            </div>
        </div>
    </header>

    <div class="main-container">
        <aside class="sidebar" id="mainSidebar">
            <!-- Módulos principais com ícones atualizados -->
            <a href="DPS.html" class="menu-item active"><i class="fas fa-home"></i> <span class="sidebar-text">Início (Dashboard)</span></a>
            <a href="OpenAI%20APIs.html" class="menu-item"><i class="fas fa-robot"></i> <span class="sidebar-text">OpenAI / Tokens IA</span></a>
            <a href="recursos-indisponiveis.html" class="menu-item"><i class="fas fa-box-open"></i> <span class="sidebar-text">Recursos</span></a>
            <a href="loja-virtual.html" class="menu-item"><i class="fas fa-shopping-cart"></i> <span class="sidebar-text">Loja</span></a>
            <a href="comunicacao.html" class="menu-item"><i class="fas fa-comments"></i> <span class="sidebar-text">Comunicação</span></a>
            <a href="seo.html" class="menu-item"><i class="fas fa-search-plus"></i> <span class="sidebar-text">SEO</span></a>
            <a href="analise.html" class="menu-item"><i class="fas fa-chart-bar"></i> <span class="sidebar-text">Análise</span></a>
            <a href="configuracoes.html" class="menu-item"><i class="fas fa-cog"></i> <span class="sidebar-text">Configurações</span></a>
            
            <!-- Separador visual -->
            <div style="height: 1px; background: var(--border-color); margin: 1rem 0;"></div>
            
            <!-- Outros módulos -->
            <a href="atualizacoes.html" class="menu-item"><i class="fas fa-sync-alt"></i> <span class="sidebar-text">Atualizações/Postagens</span></a>
            <a href="notificacoes.html" class="menu-item"><i class="fas fa-bell"></i> <span class="sidebar-text">Notificações</span></a>
            <a href="recursos-indisponiveis.html" class="menu-item"><i class="fas fa-ban"></i> <span class="sidebar-text">Recursos Indisponíveis</span></a>
            <a href="modelos.html" class="menu-item"><i class="fas fa-clone"></i> <span class="sidebar-text">Modelos</span></a>
            <a href="cardapio.html" class="menu-item"><i class="fas fa-utensils"></i> <span class="sidebar-text">Cardápio</span></a>
            <a href="assinantes.html" class="menu-item"><i class="fas fa-users"></i> <span class="sidebar-text">Assinantes</span></a>
            <a href="dominio.html" class="menu-item"><i class="fas fa-globe"></i> <span class="sidebar-text">Domínio</span></a>
            <a href="Dashboard.html" class="menu-item"><i class="fas fa-tachometer-alt"></i> <span class="sidebar-text">Monitoramento em Tempo Real</span></a>
            <a href="integracao.html" class="menu-item"><i class="fas fa-plug"></i> <span class="sidebar-text">Integração</span></a>
            <a href="manutencao.html" class="menu-item"><i class="fas fa-tools"></i> <span class="sidebar-text">Manutenção</span></a>
            <a href="indicar.html" class="menu-item"><i class="fas fa-gift"></i> <span class="sidebar-text">Indique e ganhe</span></a>
            <a href="ajuda.html" class="menu-item"><i class="fas fa-question-circle"></i> <span class="sidebar-text">Sobre e ajuda</span></a>
            <a href="code-assistant.html" class="menu-item"><i class="fas fa-code"></i> <span class="sidebar-text">Assistente de Código</span></a>
            <a href="api-dashboard.html" class="menu-item"><i class="fas fa-plug"></i> <span class="sidebar-text">Dashboard APIs</span></a>
            <a href="removeai.html" class="menu-item"><i class="fas fa-eraser"></i> <span class="sidebar-text">Remoção de Fundo</span></a>
            <a href="logout.html" class="menu-item"><i class="fas fa-sign-in-alt"></i> <span class="sidebar-text">ENTRAR</span></a>
        </aside>

        <main class="content">
            <div id="dynamic-content">
                <div class="page-header">
                    <h1 class="page-title">
                        <i class="fas fa-home"></i>
                        Bem-vindo ao D.Pedro Soluções
                    </h1>
                    <div>
                        <button class="btn btn-primary" id="newProjectBtn">
                            <i class="fas fa-plus"></i> Novo Projeto
                        </button>
                    </div>
                </div>

                <!-- Informações do Usuário -->
                <div class="user-profile-card" id="userProfileSection">
                    <div class="profile-header">
                        <img id="profileAvatar" src="" alt="Avatar do usuário" class="profile-avatar">
                        <div class="profile-info">
                            <h3 id="profileName">Carregando...</h3>
                            <p id="profileRole">Função do usuário</p>
                            <p id="profileEmail" style="font-size: 0.9rem; color: #666;">carregando@email.com</p>
                        </div>
                    </div>
                    <div class="profile-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="profileProjects">0</div>
                            <div class="stat-label">Projetos</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="profileTasks">0</div>
                            <div class="stat-label">Tarefas</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="profileClients">0</div>
                            <div class="stat-label">Clientes</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="profileRating">0.0</div>
                            <div class="stat-label">Avaliação</div>
                        </div>
                    </div>
                    <div class="d-flex gap-2">
                        <a href="profile.html" class="btn btn-primary btn-sm">
                            <i class="fas fa-edit"></i> Editar Perfil
                        </a>
                        <button class="btn btn-secondary btn-sm" id="refreshProfileBtn">
                            <i class="fas fa-sync-alt"></i> Atualizar
                        </button>
                    </div>
                </div>

                <!-- Módulos Principais em Cards -->
                <div class="row" style="display: flex; flex-wrap: wrap; gap: 1.5rem; margin-bottom: 2rem;">
                    <div class="col-md-3 col-sm-6">
                        <div class="module-card" onclick="navigateTo('DPS.html')">
                            <div class="module-icon" style="background-color: var(--primary-color);">
                                <i class="fas fa-home"></i>
                            </div>
                            <div class="module-title">Início</div>
                            <div class="module-description">Visão geral, métricas e gráficos em tempo real.</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="module-card" onclick="navigateTo('OpenAI APIs.html')">
                            <div class="module-icon" style="background-color: var(--info-color);">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div class="module-title">OpenAI / Tokens IA</div>
                            <div class="module-description">Gerencie a integração com a IA e seus créditos de tokens.</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="module-card" onclick="navigateTo('recursos-indisponiveis.html')">
                            <div class="module-icon" style="background-color: var(--warning-color);">
                                <i class="fas fa-box-open"></i>
                            </div>
                            <div class="module-title">Recursos</div>
                            <div class="module-description">Acesso às funcionalidades específicas de gestão.</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="module-card" onclick="navigateTo('loja-virtual.html')">
                            <div class="module-icon" style="background-color: var(--success-color);">
                                <i class="fas fa-shopping-cart"></i>
                            </div>
                            <div class="module-title">Loja</div>
                            <div class="module-description">Módulo de Comércio Eletrônico (Loja Virtual).</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="module-card" onclick="navigateTo('comunicacao.html')">
                            <div class="module-icon" style="background-color: var(--secondary-color);">
                                <i class="fas fa-comments"></i>
                            </div>
                            <div class="module-title">Comunicação</div>
                            <div class="module-description">Chat, sistema de tickets e comunicação interna.</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="module-card" onclick="navigateTo('seo.html')">
                            <div class="module-icon" style="background-color: var(--info-color);">
                                <i class="fas fa-search-plus"></i>
                            </div>
                            <div class="module-title">SEO</div>
                            <div class="module-description">Ferramentas para otimização de sites e análise de tráfego.</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="module-card" onclick="navigateTo('analise.html')">
                            <div class="module-icon" style="background-color: var(--primary-color);">
                                <i class="fas fa-chart-bar"></i>
                            </div>
                            <div class="module-title">Análise</div>
                            <div class="module-description">Relatórios detalhados e métricas avançadas.</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="module-card" onclick="navigateTo('configuracoes.html')">
                            <div class="module-icon" style="background-color: var(--dark-color);">
                                <i class="fas fa-cog"></i>
                            </div>
                            <div class="module-title">Configurações</div>
                            <div class="module-description">Personalize o sistema e gerencie permissões.</div>
                        </div>
                    </div>
                </div>

                <!-- Status das APIs -->
                <div class="card">
                    <div class="card-header">
                        <h4><i class="fas fa-plug"></i> Status das APIs Integradas</h4>
                    </div>
                    <div class="card-body">
                        <div class="row" id="apiStatusContainer">
                            <!-- Status das APIs será carregado aqui -->
                        </div>
                    </div>
                </div>
                
                <!-- Dashboard Widgets com dados em tempo real -->
                <div class="row" style="display: flex; flex-wrap: wrap; gap: 1.5rem; margin-bottom: 1.5rem;">
                    <div class="dashboard-widget">
                        <div class="widget-icon" style="background-color: var(--secondary-color);">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="widget-value" id="clientsCount">0</div>
                        <div class="widget-title">Clientes Ativos</div>
                        <small style="color: var(--success-color);">
                            <i class="fas fa-arrow-up"></i> <span id="clientsGrowth">0%</span> este mês
                        </small>
                    </div>
                    
                    <div class="dashboard-widget">
                        <div class="widget-icon" style="background-color: var(--success-color);">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <div class="widget-value" id="salesAmount">AOA 0</div>
                        <div class="widget-title">Vendas Mensais</div>
                        <small style="color: var(--success-color);">
                            <i class="fas fa-arrow-up"></i> <span id="salesGrowth">0%</span> este mês
                        </small>
                    </div>
                    
                    <div class="dashboard-widget">
                        <div class="widget-icon" style="background-color: var(--warning-color);">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="widget-value" id="goalProgress">0%</div>
                        <div class="widget-title">Meta Anual</div>
                        <small style="color: var(--success-color);">
                            <i class="fas fa-arrow-up"></i> <span id="goalGrowth">0%</span> este mês
                        </small>
                    </div>
                    
                    <div class="dashboard-widget">
                        <div class="widget-icon" style="background-color: var(--info-color);">
                            <i class="fas fa-tasks"></i>
                        </div>
                        <div class="widget-value" id="projectsCompleted">0/0</div>
                        <div class="widget-title">Projetos Concluídos</div>
                        <small style="color: var(--warning-color);">
                            <i class="fas fa-clock"></i> <span id="projectsPending">0</span> pendentes
                        </small>
                    </div>
                </div>
                
                <!-- Gráficos em Tempo Real -->
                <div class="row" style="display: flex; flex-wrap: wrap; gap: 1.5rem; margin-bottom: 1.5rem;">
                    <div class="card" style="flex: 2; min-width: 300px;">
                        <h4>Desempenho de Vendas</h4>
                        <div class="chart-container">
                            <canvas id="salesChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="card" style="flex: 1; min-width: 250px;">
                        <h4>Distribuição de Projetos</h4>
                        <div class="chart-container">
                            <canvas id="projectsChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Assistente IA Flutuante -->
    <div class="ai-assistant ai-assistant-pulse" id="aiAssistantBtn">
        <i class="fas fa-robot"></i>
    </div>

    <!-- Toggle de Tema Escuro/Claro -->
    <div class="dark-mode-toggle" id="darkModeToggle">
        <i class="fas fa-moon"></i>
    </div>

    <!-- Status de Conexão -->
    <div class="connection-status" id="connectionStatus">
        <i class="fas fa-circle"></i> <span id="connectionText">Conectando...</span>
    </div>

    <!-- Toast de Notificação -->
    <div class="notification-toast" id="notificationToast">
        <div class="notification-icon" style="background-color: var(--success-color);">
            <i class="fas fa-check"></i>
        </div>
        <div style="flex: 1;">
            <div style="font-weight: 500;" id="toastTitle">Sistema Carregado</div>
            <div style="font-size: 0.9rem; color: #666;" id="toastMessage">D.Pedro Soluções está pronto para uso</div>
        </div>
        <button class="notification-close" id="toastClose">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <!-- Modal do Assistente IA -->
    <div class="modal fade" id="aiAssistantModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-robot"></i> Assistente IA</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="chat-messages" id="chatMessages">
                        <div class="chat-message system-message">
                            <strong>Assistente IA:</strong> Olá! Sou seu assistente de IA. Como posso ajudá-lo hoje?
                        </div>
                    </div>
                    <div class="input-group mt-3">
                        <input type="text" class="form-control" id="chatInput" placeholder="Digite sua pergunta...">
                        <button class="btn btn-primary" id="sendMessageBtn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // =============================================
        // SISTEMA DE PERFIL DO USUÁRIO
        // =============================================

        // Simulação de API para dados do perfil
        const profileAPI = {
            // Buscar dados do perfil do usuário
            getProfile: () => {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        // Simular dados do perfil do usuário
                        // Em um sistema real, isso viria do localStorage, sessionStorage ou de uma API
                        const profileData = localStorage.getItem('userProfileData');
                        
                        if (profileData) {
                            resolve(JSON.parse(profileData));
                        } else {
                            // Dados padrão caso não exista perfil salvo
                            resolve({
                                id: 1,
                                name: "João Silva",
                                email: "joao.silva@empresa.com",
                                role: "Administrador do Sistema",
                                avatar: "https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                                stats: {
                                    projects: 12,
                                    tasks: 24,
                                    clients: 8,
                                    rating: 4.8
                                },
                                joinDate: "2023-01-15",
                                lastLogin: new Date().toISOString(),
                                preferences: {
                                    theme: "light",
                                    notifications: true,
                                    language: "pt-BR"
                                }
                            });
                        }
                    }, 500);
                });
            },

            // Atualizar dados do perfil
            updateProfile: (profileData) => {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        localStorage.setItem('userProfileData', JSON.stringify(profileData));
                        resolve({ success: true, profile: profileData });
                    }, 300);
                });
            },

            // Buscar dados da página profile.html (simulação)
            getProfileFromPage: () => {
                return new Promise((resolve) => {
                    // Em um sistema real, isso faria uma requisição para profile.html
                    // ou buscaria dados de uma API específica
                    setTimeout(() => {
                        // Simular dados que viriam da página de perfil
                        const profileFromPage = {
                            name: "Maria Santos",
                            email: "maria.santos@empresa.com",
                            role: "Gerente de Projetos",
                            avatar: "https://images.unsplash.com/photo-1494790108755-2616b612b786?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",
                            phone: "+244 123 456 789",
                            department: "Tecnologia",
                            location: "Luanda, Angola"
                        };
                        resolve(profileFromPage);
                    }, 400);
                });
            }
        };

        // =============================================
        // IMPLEMENTAÇÃO DO FRONTEND - INTEGRAÇÃO COM PERFIL
        // =============================================

        // Inicialização do sistema
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar componentes
            initializeDashboard();
            initializeSidebar();
            initializeNotifications();
            initializeAIAssistant();
            initializeCharts();
            initializeWebSocket();
            
            // Carregar dados do perfil do usuário
            loadUserProfile();
            
            // Mostrar toast de boas-vindas
            setTimeout(() => {
                showNotification('Sistema Carregado', 'D.Pedro Soluções está pronto para uso', 'success');
            }, 1000);
        });

        // Carregar perfil do usuário
        async function loadUserProfile() {
            try {
                // Mostrar estado de carregamento
                document.getElementById('userName').textContent = 'Carregando...';
                document.getElementById('profileName').textContent = 'Carregando...';
                
                // Buscar dados do perfil
                const profileData = await profileAPI.getProfile();
                
                // Atualizar interface com dados do perfil
                updateUserInterface(profileData);
                
                // Tentar buscar dados atualizados da página de perfil
                try {
                    const updatedProfile = await profileAPI.getProfileFromPage();
                    // Mesclar dados (priorizando dados da página de perfil)
                    const mergedProfile = { ...profileData, ...updatedProfile };
                    updateUserInterface(mergedProfile);
                    
                    // Salvar dados mesclados
                    await profileAPI.updateProfile(mergedProfile);
                    
                    showNotification('Perfil Atualizado', 'Dados do perfil sincronizados com sucesso', 'success');
                } catch (error) {
                    console.log('Não foi possível buscar dados atualizados do perfil:', error);
                }
                
            } catch (error) {
                console.error('Erro ao carregar perfil do usuário:', error);
                showNotification('Erro', 'Não foi possível carregar os dados do perfil', 'danger');
                
                // Usar dados padrão em caso de erro
                const defaultProfile = {
                    name: "Usuário",
                    email: "usuario@empresa.com",
                    role: "Usuário do Sistema",
                    avatar: "https://i.postimg.cc/7YQvLZxX/user-avatar.jpg",
                    stats: {
                        projects: 0,
                        tasks: 0,
                        clients: 0,
                        rating: 0.0
                    }
                };
                updateUserInterface(defaultProfile);
            }
        }

        // Atualizar interface com dados do perfil
        function updateUserInterface(profileData) {
            // Atualizar header
            document.getElementById('userName').textContent = profileData.name;
            document.getElementById('userAvatar').src = profileData.avatar;
            
            // Atualizar seção de perfil
            document.getElementById('profileName').textContent = profileData.name;
            document.getElementById('profileRole').textContent = profileData.role;
            document.getElementById('profileEmail').textContent = profileData.email;
            document.getElementById('profileAvatar').src = profileData.avatar;
            
            // Atualizar estatísticas
            if (profileData.stats) {
                document.getElementById('profileProjects').textContent = profileData.stats.projects;
                document.getElementById('profileTasks').textContent = profileData.stats.tasks;
                document.getElementById('profileClients').textContent = profileData.stats.clients;
                document.getElementById('profileRating').textContent = profileData.stats.rating.toFixed(1);
            }
            
            // Aplicar preferências do usuário
            if (profileData.preferences) {
                if (profileData.preferences.theme) {
                    document.documentElement.setAttribute('data-theme', profileData.preferences.theme);
                    const themeIcon = document.querySelector('#darkModeToggle i');
                    themeIcon.className = profileData.preferences.theme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
                }
            }
            
            console.log('Perfil do usuário carregado:', profileData);
        }

        // =============================================
        // RESTANTE DA IMPLEMENTAÇÃO DO SISTEMA
        // =============================================

        // Simulação de banco de dados em memória
        const database = {
            metrics: {
                clientsCount: 127,
                salesAmount: 2450000,
                goalProgress: 68,
                projectsCompleted: 24,
                totalProjects: 32,
                clientsGrowth: 5.2,
                salesGrowth: 12.8,
                goalGrowth: 8,
                projectsPending: 8
            },
            notifications: [
                { id: 1, title: "Novo projeto adicionado", message: "O projeto 'Sistema de Gestão' foi criado com sucesso", timestamp: "2023-07-20T14:25:00Z", read: false, type: "info" },
                { id: 2, title: "API OpenAI conectada", message: "Conexão com a API OpenAI estabelecida com sucesso", timestamp: "2023-07-20T13:45:00Z", read: false, type: "success" },
                { id: 3, title: "Atualização do sistema disponível", message: "Nova versão 2.1.0 disponível para instalação", timestamp: "2023-07-20T10:30:00Z", read: false, type: "warning" }
            ],
            apiStatus: [
                { name: "OpenAI GPT", status: "connected", lastCheck: "2023-07-20 14:30" },
                { name: "WebSocket", status: "connected", lastCheck: "2023-07-20 14:32" },
                { name: "DPS Loja", status: "connected", lastCheck: "2023-07-20 14:25" },
                { name: "DPS Tokens", status: "connecting", lastCheck: "2023-07-20 14:28" },
                { name: "Sistema de Notificações", status: "connected", lastCheck: "2023-07-20 14:35" }
            ]
        };

        // Simulação de APIs REST
        const api = {
            getMetrics: () => {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        database.metrics.clientsCount += Math.floor(Math.random() * 3) - 1;
                        database.metrics.salesAmount += Math.floor(Math.random() * 50000) - 25000;
                        database.metrics.goalProgress += Math.floor(Math.random() * 2) - 1;
                        
                        database.metrics.clientsCount = Math.max(100, database.metrics.clientsCount);
                        database.metrics.salesAmount = Math.max(2000000, database.metrics.salesAmount);
                        database.metrics.goalProgress = Math.max(0, Math.min(100, database.metrics.goalProgress));
                        
                        resolve({...database.metrics});
                    }, 300);
                });
            },

            getNotifications: () => {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        const unreadCount = database.notifications.filter(n => !n.read).length;
                        resolve({
                            count: unreadCount,
                            notifications: database.notifications.slice(0, 5)
                        });
                    }, 200);
                });
            },

            markAsRead: (id) => {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        const notification = database.notifications.find(n => n.id === id);
                        if (notification) {
                            notification.read = true;
                        }
                        resolve({ success: true });
                    }, 100);
                });
            },

            getApiStatus: () => {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        resolve([...database.apiStatus]);
                    }, 250);
                });
            }
        };

        // Inicializar Dashboard com dados reais
        async function initializeDashboard() {
            await updateRealTimeData();
            await loadAPIStatus();
            setInterval(updateRealTimeData, 30000);
        }

        // Atualizar dados em tempo real
        async function updateRealTimeData() {
            try {
                const metrics = await api.getMetrics();
                
                document.getElementById('clientsCount').textContent = metrics.clientsCount;
                document.getElementById('salesAmount').textContent = 'AOA ' + metrics.salesAmount.toLocaleString('pt-BR');
                document.getElementById('goalProgress').textContent = metrics.goalProgress + '%';
                document.getElementById('projectsCompleted').textContent = metrics.projectsCompleted + '/' + metrics.totalProjects;
                document.getElementById('clientsGrowth').textContent = metrics.clientsGrowth.toFixed(1) + '%';
                document.getElementById('salesGrowth').textContent = metrics.salesGrowth.toFixed(1) + '%';
                document.getElementById('goalGrowth').textContent = metrics.goalGrowth.toFixed(1) + '%';
                document.getElementById('projectsPending').textContent = metrics.projectsPending;
                
                updateCharts(metrics);
                
            } catch (error) {
                console.error('Erro ao atualizar dados em tempo real:', error);
            }
        }

        // Carregar status das APIs
        async function loadAPIStatus() {
            try {
                const apiStatus = await api.getApiStatus();
                const apiContainer = document.getElementById('apiStatusContainer');
                apiContainer.innerHTML = '';
                
                apiStatus.forEach(api => {
                    const statusClass = api.status === 'connected' ? 'api-status connected' : 
                                      api.status === 'disconnected' ? 'api-status disconnected' : 'api-status connecting';
                    
                    const statusText = api.status === 'connected' ? 'Conectado' : 
                                     api.status === 'disconnected' ? 'Desconectado' : 'Conectando...';
                    
                    const col = document.createElement('div');
                    col.className = 'col-md-4 mb-3';
                    col.innerHTML = `
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">${api.name}</h5>
                                <p class="card-text">
                                    <span class="${statusClass}">${statusText}</span>
                                </p>
                                <small class="text-muted">Última verificação: ${api.lastCheck}</small>
                            </div>
                        </div>
                    `;
                    apiContainer.appendChild(col);
                });
            } catch (error) {
                console.error('Erro ao carregar status das APIs:', error);
            }
        }

        // Inicializar gráficos
        function initializeCharts() {
            const salesCtx = document.getElementById('salesChart').getContext('2d');
            window.salesChart = new Chart(salesCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul'],
                    datasets: [{
                        label: 'Vendas (milhares AOA)',
                        data: [1200, 1900, 1500, 2200, 1800, 2450, 2100],
                        borderColor: '#4361ee',
                        backgroundColor: 'rgba(67, 97, 238, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
            
            const projectsCtx = document.getElementById('projectsChart').getContext('2d');
            window.projectsChart = new Chart(projectsCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Sistemas', 'CFTV', 'Controle de Acesso', 'Redes'],
                    datasets: [{
                        data: [12, 8, 5, 7],
                        backgroundColor: [
                            '#4361ee',
                            '#3f37c9',
                            '#4cc9f0',
                            '#3a0ca3'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Atualizar gráficos com dados reais
        function updateCharts(metrics) {
            if (window.salesChart) {
                const newData = window.salesChart.data.datasets[0].data.map(value => {
                    return value + Math.floor(Math.random() * 100) - 50;
                });
                window.salesChart.data.datasets[0].data = newData;
                window.salesChart.update();
            }
        }

        // Inicializar sidebar
        function initializeSidebar() {
            const sidebar = document.getElementById('mainSidebar');
            const sidebarToggle = document.getElementById('sidebarToggle');
            
            if (sidebarToggle) {
                sidebarToggle.addEventListener('click', function() {
                    sidebar.classList.toggle('show');
                });
            }
            
            const sidebarItems = sidebar.querySelectorAll('.menu-item');
            sidebarItems.forEach(item => {
                item.addEventListener('click', function() {
                    if (window.innerWidth <= 768) {
                        sidebar.classList.remove('show');
                    }
                });
            });
        }

        // Inicializar sistema de notificações
        async function initializeNotifications() {
            const notificationsBtn = document.getElementById('notificationsBtn');
            const notificationsDropdown = document.getElementById('notificationsDropdown');
            const userMenuBtn = document.getElementById('userMenuBtn');
            const userMenuDropdown = document.getElementById('userMenuDropdown');
            
            await loadNotifications();
            
            if (notificationsBtn && notificationsDropdown) {
                notificationsBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    notificationsDropdown.style.display = notificationsDropdown.style.display === 'block' ? 'none' : 'block';
                    userMenuDropdown.style.display = 'none';
                });
            }
            
            if (userMenuBtn && userMenuDropdown) {
                userMenuBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    userMenuDropdown.style.display = userMenuDropdown.style.display === 'block' ? 'none' : 'block';
                    notificationsDropdown.style.display = 'none';
                });
            }
            
            document.addEventListener('click', function(e) {
                if (!e.target.closest('#notificationsBtn') && !e.target.closest('#notificationsDropdown')) {
                    notificationsDropdown.style.display = 'none';
                }
                if (!e.target.closest('#userMenuBtn') && !e.target.closest('#userMenuDropdown')) {
                    userMenuDropdown.style.display = 'none';
                }
            });
        }

        // Carregar notificações
        async function loadNotifications() {
            try {
                const notificationData = await api.getNotifications();
                const notificationCount = document.getElementById('notificationCount');
                const notificationList = document.getElementById('notificationList');
                
                notificationCount.textContent = notificationData.count;
                notificationList.innerHTML = '';
                
                if (notificationData.notifications.length === 0) {
                    notificationList.innerHTML = '<div class="text-center py-3"><p>Nenhuma notificação</p></div>';
                } else {
                    notificationData.notifications.forEach(notification => {
                        const notificationItem = document.createElement('div');
                        notificationItem.className = `notification-item ${notification.read ? 'read' : 'unread'}`;
                        notificationItem.style.cssText = 'padding: 0.5rem 0; border-bottom: 1px solid var(--border-color); cursor: pointer;';
                        
                        const date = new Date(notification.timestamp);
                        const formattedDate = date.toLocaleDateString('pt-BR') + ' ' + date.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
                        
                        notificationItem.innerHTML = `
                            <div style="font-weight: ${notification.read ? '400' : '500'};">${notification.title}</div>
                            <small style="color: #999;">${formattedDate}</small>
                        `;
                        
                        notificationItem.addEventListener('click', async () => {
                            if (!notification.read) {
                                await api.markAsRead(notification.id);
                                await loadNotifications();
                            }
                        });
                        
                        notificationList.appendChild(notificationItem);
                    });
                }
            } catch (error) {
                console.error('Erro ao carregar notificações:', error);
            }
        }

        // Simulação de WebSocket
        class WebSocketSimulator {
            constructor() {
                this.connected = false;
                this.listeners = {
                    open: [],
                    message: [],
                    close: []
                };
            }

            connect() {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        this.connected = true;
                        this.triggerEvent('open');
                        this.simulateServerMessages();
                        resolve();
                    }, 1000);
                });
            }

            simulateServerMessages() {
                setInterval(() => {
                    if (this.connected) {
                        this.triggerEvent('message', {
                            type: 'metrics_update',
                            data: database.metrics
                        });
                    }
                }, 10000);

                setInterval(() => {
                    if (this.connected && Math.random() > 0.7) {
                        const newNotification = {
                            id: Date.now(),
                            title: "Nova atividade no sistema",
                            message: "Há novas atividades que requerem sua atenção",
                            timestamp: new Date().toISOString(),
                            read: false,
                            type: "info"
                        };
                        
                        database.notifications.unshift(newNotification);
                        
                        this.triggerEvent('message', {
                            type: 'new_notification',
                            data: newNotification
                        });
                    }
                }, 15000);
            }

            addEventListener(event, callback) {
                if (!this.listeners[event]) {
                    this.listeners[event] = [];
                }
                this.listeners[event].push(callback);
            }

            triggerEvent(event, data) {
                if (this.listeners[event]) {
                    this.listeners[event].forEach(callback => {
                        callback(data);
                    });
                }
            }

            send(data) {
                console.log('Enviando para WebSocket:', data);
            }

            close() {
                this.connected = false;
                this.triggerEvent('close');
            }
        }

        // Inicializar WebSocket
        function initializeWebSocket() {
            const connectionStatus = document.getElementById('connectionStatus');
            const connectionText = document.getElementById('connectionText');
            
            const ws = new WebSocketSimulator();
            
            ws.addEventListener('open', () => {
                connectionStatus.className = 'connection-status connected';
                connectionText.innerHTML = '<i class="fas fa-circle"></i> Conectado';
                showNotification('Conexão Estabelecida', 'WebSocket conectado com sucesso', 'success');
            });
            
            ws.addEventListener('close', () => {
                connectionStatus.className = 'connection-status disconnected';
                connectionText.innerHTML = '<i class="fas fa-circle"></i> Desconectado';
            });
            
            ws.addEventListener('message', (data) => {
                if (data.type === 'metrics_update') {
                    updateMetricsFromWebSocket(data.data);
                } else if (data.type === 'new_notification') {
                    showNotification(data.data.title, data.data.message, 'info');
                    loadNotifications();
                }
            });
            
            ws.connect().catch(error => {
                console.error('Erro ao conectar WebSocket:', error);
                connectionStatus.className = 'connection-status disconnected';
                connectionText.innerHTML = '<i class="fas fa-circle"></i> Erro de Conexão';
            });
            
            return ws;
        }

        // Atualizar métricas a partir do WebSocket
        function updateMetricsFromWebSocket(metrics) {
            document.getElementById('clientsCount').textContent = metrics.clientsCount;
            document.getElementById('salesAmount').textContent = 'AOA ' + metrics.salesAmount.toLocaleString('pt-BR');
            document.getElementById('goalProgress').textContent = metrics.goalProgress + '%';
            document.getElementById('projectsCompleted').textContent = metrics.projectsCompleted + '/' + metrics.totalProjects;
        }

        // Inicializar assistente IA
        function initializeAIAssistant() {
            const aiAssistantBtn = document.getElementById('aiAssistantBtn');
            const aiAssistantModal = new bootstrap.Modal(document.getElementById('aiAssistantModal'));
            const sendMessageBtn = document.getElementById('sendMessageBtn');
            const chatInput = document.getElementById('chatInput');
            const chatMessages = document.getElementById('chatMessages');
            
            aiAssistantBtn.addEventListener('click', function() {
                aiAssistantModal.show();
            });
            
            sendMessageBtn.addEventListener('click', sendMessage);
            chatInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
            function sendMessage() {
                const message = chatInput.value.trim();
                if (message) {
                    addChatMessage(message, 'user');
                    chatInput.value = '';
                    
                    setTimeout(() => {
                        const responses = [
                            "Entendi sua pergunta. Posso ajudar com informações sobre o sistema D.Pedro Soluções.",
                            "Com base nos dados disponíveis, posso sugerir algumas opções para otimizar seu trabalho.",
                            "Para essa funcionalidade, você pode acessar a seção específica no menu lateral.",
                            "Posso gerar um relatório com essas informações. Deseja prosseguir?",
                            "Há uma atualização disponível para esse módulo. Recomendo verificar as atualizações."
                        ];
                        const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                        addChatMessage(randomResponse, 'ai');
                    }, 1000);
                }
            }
            
            function addChatMessage(message, sender) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `chat-message ${sender}-message`;
                messageDiv.innerHTML = `<strong>${sender === 'user' ? 'Você' : 'Assistente IA'}:</strong> ${message}`;
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        }

        // Funções auxiliares
        function showNotification(title, message, type = 'info') {
            const toast = document.getElementById('notificationToast');
            const toastTitle = document.getElementById('toastTitle');
            const toastMessage = document.getElementById('toastMessage');
            const toastIcon = toast.querySelector('.notification-icon');
            
            let bgColor = '#4361ee';
            if (type === 'success') bgColor = '#4cc9f0';
            if (type === 'warning') bgColor = '#ffc107';
            if (type === 'danger') bgColor = '#dc3545';
            
            toastIcon.style.backgroundColor = bgColor;
            toastTitle.textContent = title;
            toastMessage.textContent = message;
            
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 5000);
        }

        // Fechar toast manualmente
        document.getElementById('toastClose').addEventListener('click', function() {
            document.getElementById('notificationToast').classList.remove('show');
        });

        // Alternar tema escuro/claro
        document.getElementById('darkModeToggle').addEventListener('click', function() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            
            const icon = this.querySelector('i');
            icon.className = newTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
            
            localStorage.setItem('theme', newTheme);
            
            // Atualizar preferência no perfil do usuário
            updateUserThemePreference(newTheme);
            
            showNotification('Tema Alterado', `Modo ${newTheme === 'dark' ? 'escuro' : 'claro'} ativado`, 'info');
        });

        // Atualizar preferência de tema no perfil do usuário
        async function updateUserThemePreference(theme) {
            try {
                const currentProfile = await profileAPI.getProfile();
                if (!currentProfile.preferences) {
                    currentProfile.preferences = {};
                }
                currentProfile.preferences.theme = theme;
                await profileAPI.updateProfile(currentProfile);
            } catch (error) {
                console.error('Erro ao atualizar preferência de tema:', error);
            }
        }

        // Carregar tema salvo
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
        const themeIcon = document.querySelector('#darkModeToggle i');
        themeIcon.className = savedTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';

        // Navegação para módulos
        function navigateTo(url) {
            window.location.href = url;
        }

        // Novo projeto
        document.getElementById('newProjectBtn').addEventListener('click', function() {
            showNotification('Novo Projeto', 'Abrindo formulário para novo projeto', 'info');
        });

        // Botão para atualizar perfil
        document.getElementById('refreshProfileBtn').addEventListener('click', function() {
            loadUserProfile();
            showNotification('Perfil', 'Atualizando dados do perfil...', 'info');
        });
    </script>
</body>
</html>